<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>meta-debian</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body class="light">
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { } 
            if (theme === null || theme === undefined) { theme = default_theme; }
            document.body.className = theme;
            document.querySelector('html').className = theme + ' js';
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <ol class="chapter"><li><a href="1.getting_started.html"><strong aria-hidden="true">1.</strong> Getting Started</a></li><li><a href="2.components.html"><strong aria-hidden="true">2.</strong> Components</a></li><li><a href="3.development.html"><strong aria-hidden="true">3.</strong> Development</a></li><li><ol class="section"><li><a href="3.development/3.1.create_recipe.html"><strong aria-hidden="true">3.1.</strong> Create recipe</a></li><li><a href="3.development/3.2.example.html"><strong aria-hidden="true">3.2.</strong> Example</a></li></ol></li><li><a href="4.bsp.html"><strong aria-hidden="true">4.</strong> BSP</a></li><li><ol class="section"><li><a href="4.bsp/4.1.bbb.html"><strong aria-hidden="true">4.1.</strong> BeagleBone Black</a></li><li><a href="4.bsp/4.2.pi.html"><strong aria-hidden="true">4.2.</strong> Raspberry Pi</a></li></ol></li><li><a href="5.appendix.html"><strong aria-hidden="true">5.</strong> Appendix</a></li><li class="affix"><a href="community_resources.html">Community Resources</a></li><li class="affix"><a href="license.html">LICENSE</a></li></ol>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar" class="menu-bar">
                    <div id="menu-bar-sticky-container">
                        <div class="left-buttons">
                            <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                                <i class="fa fa-bars"></i>
                            </button>
                            <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                                <i class="fa fa-paint-brush"></i>
                            </button>
                            <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                                <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            </ul>
                            
                            <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                                <i class="fa fa-search"></i>
                            </button>
                            
                        </div>

                        <h1 class="menu-title">meta-debian</h1> 

                        <div class="right-buttons">
                            <a href="print.html" title="Print this book" aria-label="Print this book">
                                <i id="print-button" class="fa fa-print"></i>
                            </a>
                            
                        </div>
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <a class="header" href="#what-is-meta-debian" id="what-is-meta-debian"><h1>What is meta-debian?</h1></a>
<p>meta-debian is a set of recipes (metadata) for the poky build system,
which allows cross-building GNU/Linux images using Debian source packages.
By enabling meta-debian, you can cross-build a small GNU/Linux image
with Debian sources for multiple architectures.</p>
<p>The main purpose of meta-debian is to provide reference Linux distribution
for embedded systems satisfying the following needs.</p>
<ul>
<li>Long-term support</li>
<li>Stability</li>
<li>Wide embedded CPU support</li>
<li>Customizability</li>
</ul>
<p>Currently, the following software versions are supported in meta-debian.</p>
<ul>
<li>Source code: Debian GNU/Linux 10 (buster)</li>
<li>Build system: Yocto Project (warrior)</li>
</ul>
<a class="header" href="#quick-start" id="quick-start"><h1>Quick Start</h1></a>
<p>meta-debian can be built in a docker container or on a Linux machine (native build).</p>
<a class="header" href="#setup-build-environment" id="setup-build-environment"><h3>Setup build environment</h3></a>
<p>Clone meta-debian:</p>
<pre><code class="language-sh">$ git clone -b warrior https://github.com/meta-debian/meta-debian.git
</code></pre>
<ul>
<li>
<p>For docker build:</p>
<pre><code class="language-sh">$ cd meta-debian
$ make -C docker
</code></pre>
</li>
<li>
<p>For native build:</p>
<ul>
<li>
<p>Install essential packages poky requires into your host system according to
<a href="https://www.yoctoproject.org/docs/2.7/ref-manual/ref-manual.html#required-packages-for-the-build-host">https://www.yoctoproject.org/docs/2.7/ref-manual/ref-manual.html#required-packages-for-the-build-host</a></p>
<pre><code class="language-sh">$ sudo apt-get install gawk wget git-core diffstat unzip texinfo gcc-multilib \
build-essential chrpath socat cpio python python3 python3-pip python3-pexpect \
xz-utils debianutils iputils-ping
</code></pre>
<p>NOTE: The following three packages have version limitation</p>
<ul>
<li>git: 1.8.3.1 or greater</li>
<li>tar: 1.27 or greater</li>
<li>python: 3.4.0 or greater</li>
</ul>
</li>
<li>
<p>Setup repositories</p>
<pre><code class="language-sh">$ git clone -b warrior git://git.yoctoproject.org/poky.git
$ mv meta-debian poky/
</code></pre>
</li>
</ul>
</li>
</ul>
<a class="header" href="#build" id="build"><h3>Build</h3></a>
<pre><code class="language-sh">export TEMPLATECONF=meta-debian/conf
source ./poky/oe-init-build-env
</code></pre>
<p>You can change the target machine by setting <code>MACHINE</code> variable
in <code>conf/local.conf</code> to one of the following machines.</p>
<ul>
<li>qemux86 (default)</li>
<li>qemux86-64</li>
<li>qemuarm</li>
<li>qemuarm64</li>
<li>qemuppc</li>
<li>qemumips</li>
</ul>
<p>For example, the target machine is set to QEMU ARM by adding
the following difinition to <code>conf/local.conf</code>.</p>
<pre><code>MACHINE = &quot;qemuarm&quot;
</code></pre>
<p>Now, the build system is ready.
Build Linux kernel and the minimal rootfs by the following command.
It takes a while to complete (more than 30 minutes).</p>
<pre><code class="language-sh">bitbake core-image-minimal
</code></pre>
<a class="header" href="#run-the-built-linux-on-qemu" id="run-the-built-linux-on-qemu"><h3>Run the built Linux on QEMU</h3></a>
<p>Please replace <code>${MACHINE}</code> by the target machine
you selected in the above step.</p>
<p>NOTE: Confirm that the tun module, which runqemu depends on,
is correctly loaded in your system.</p>
<pre><code class="language-sh">runqemu ${MACHINE} nographic
</code></pre>
<p>After boot, you can login as <code>root</code> without password.</p>
<a class="header" href="#components" id="components"><h1>Components</h1></a>
<p>To handle Debian package source code, <code>meta-debian</code> needs to provide
some extra functions/tasks. The following contents are not all but
main components which are defined and usually used in <code>meta-debian</code>.</p>
<a class="header" href="#classes" id="classes"><h2>Classes</h2></a>
<a class="header" href="#debian-packagebbclass" id="debian-packagebbclass"><h4>debian-package.bbclass</h4></a>
<p>Class <code>debian-package</code> is inherited by recipes.
This class provides tasks to extract source code and apply Debian patches.</p>
<a class="header" href="#debian-sourcebbclass" id="debian-sourcebbclass"><h4>debian-source.bbclass</h4></a>
<p>Class <code>debian-source</code> is inherited by <code>conf/distro/deby.conf</code>.
This class provides an eventhandler to fetch information
from Debian apt repository. This information will be
used for downloading source code.</p>
<a class="header" href="#tasks" id="tasks"><h2>Tasks</h2></a>
<a class="header" href="#do_debian_unpack_extra" id="do_debian_unpack_extra"><h4>do_debian_unpack_extra</h4></a>
<p>This is a task, defined by <code>debian-package.bbclass</code> to unpack
Debian source code into one folder.
This task runs after <code>do_unpack</code> and before <code>do_debian_patch</code></p>
<a class="header" href="#do_debian_patch" id="do_debian_patch"><h4>do_debian_patch</h4></a>
<p>This is a task, defined by <code>debian-package.bbclass</code> to apply Debian patches.
These Debian patches can be applied by <code>quilt</code>,
<code>dpatch</code> or manually with <code>patch</code>.
This task runs after <code>do_debian_unpack_extra</code> and before <code>do_patch</code>.</p>
<a class="header" href="#debian_source_eventhandler" id="debian_source_eventhandler"><h4>debian_source_eventhandler</h4></a>
<p>This is an eventhandler, defined by <code>debian-source.bbclass</code>
to generate Debian package source code information: <code>PV</code>, <code>URI</code>, <code>checksum</code>.
These kinds of information are fetched from
<code>dists/buster/main/source/Sources.xz</code> in Debian apt repository.
This eventhandler runs when <code>bb.event.ParseStarted</code> is fired.</p>
<a class="header" href="#variables" id="variables"><h2>Variables</h2></a>
<a class="header" href="#debian_src_uri" id="debian_src_uri"><h4>DEBIAN_SRC_URI</h4></a>
<p>URI to fetch Debian package source code.
By default, this variable is generated automatically in
<code>recipes-debian/sources/&lt;source_name&gt;.inc</code>.</p>
<p>Example:</p>
<pre><code class="language-sh">DEBIAN_SRC_URI = &quot; \
    ${DEBIAN_MIRROR}/main/f/flex/flex_2.6.4-6.2.dsc;name=flex_2.6.4-6.2.dsc \
    ${DEBIAN_MIRROR}/main/f/flex/flex_2.6.4.orig.tar.gz;name=flex_2.6.4.orig.tar.gz \
    ${DEBIAN_MIRROR}/main/f/flex/flex_2.6.4-6.2.diff.gz;name=flex_2.6.4-6.2.diff.gz;apply=no \
&quot;
</code></pre>
<a class="header" href="#debian_unpack_dir" id="debian_unpack_dir"><h4>DEBIAN_UNPACK_DIR</h4></a>
<p>Path to source code directory after unpacked.
This variable is initialized in <code>debian-package.bbclass</code>
with default value <code>${WORKDIR}/${BP}</code></p>
<a class="header" href="#debian_patch_type" id="debian_patch_type"><h4>DEBIAN_PATCH_TYPE</h4></a>
<p>Decide action to apply patches for the source package.
Normally, this variable will only need to be set if
patch type cannot be detected by <code>debian/source/format</code>.
Possible value:</p>
<ul>
<li><code>quilt</code>: if package uses <code>quilt</code> for applying patches.</li>
<li><code>dpatch</code>: if package uses <code>dpatch</code> for applying patches.</li>
<li><code>nopatch</code>: if there is no Debian patch.</li>
<li><code>abnormal</code>: if none of the three conditions above matched.
Recipe will need to define its own way to apply patches by
defining function <code>debian_patch_abnormal</code> or overwriting <code>do_debian_patch</code>.</li>
</ul>
<a class="header" href="#debian_quilt_patches" id="debian_quilt_patches"><h4>DEBIAN_QUILT_PATCHES</h4></a>
<p>Path to Debian patches folder, by default is
<code>${DEBIAN_UNPACK_DIR}/debian/patches</code>.
In some cases, this variable need to be unset because
<code>DEBIAN_PATCH_TYPE</code> is <code>quilt</code> but there is no patch.
For example, package <code>gawk</code> has <code>debian/source/format</code> is <code>3.0 (quilt)</code>
but there is no patch in <code>debian</code> subfolder.</p>
<a class="header" href="#debian_use_snapshot" id="debian_use_snapshot"><h4>DEBIAN_USE_SNAPSHOT</h4></a>
<p>Select snapshot.debian.org as the Debian source package download location, by default
is <code>0</code>. If you want to download package from snapshot.debianorg, you need to set <code>1</code>.</p>
<a class="header" href="#bpn" id="bpn"><h4>BPN</h4></a>
<p>In <code>meta-debian</code>, <code>BPN</code> is not just &quot;<em>a version of the PN variable with
common prefixes and suffixes removed</em>&quot; but the real Debian source package name
and usually used to specify directory path.<br />
For examples: <code>${WORKDIR}/${BPN}-${PV}</code>, <code>${libdir}/${BPN}</code>, <code>${datadir}/${BPN}</code>, ...</p>
<a class="header" href="#development" id="development"><h1>Development</h1></a>
<p>All recipes for Debian packages should be put in folder <code>recipes-debian</code>.
The next section will show you how to create a recipe in <code>meta-debian</code>.</p>
<a class="header" href="#generate-source-code-uri" id="generate-source-code-uri"><h1>Generate source code URI</h1></a>
<p>Firstly, create an empty file which will store source code information:</p>
<pre><code class="language-sh">touch recipes-debian/sources/&lt;source_name&gt;.inc
</code></pre>
<p>When bitbake run, class <code>debian-source</code> will generate information
about version, source URI and checksum to this file.</p>
<p><em>NOTE: By default, <code>debian-source</code> will not rerun if
file <code>Sources.xz</code> does not change. Force it regenerate by adding
<code>DEBIAN_SRC_FORCE_REGEN = &quot;1&quot;</code> into <code>conf/local.conf</code> in the build directory.</em></p>
<a class="header" href="#write-recipe" id="write-recipe"><h1>Write recipe</h1></a>
<p>Recipe in <code>meta-debian</code> is almost similar with recipe in <code>meta</code>,
but there are some rules need to be concerned.</p>
<a class="header" href="#recipe-name" id="recipe-name"><h3>Recipe name</h3></a>
<ul>
<li>
<p>Recipe name <code>PN</code> should be same with recipe name in layer <code>meta</code>
and has version suffix <code>_debian</code>:</p>
<pre><code>meta-debian/recipes-debian/*/&lt;PN&gt;_debian.bb
</code></pre>
</li>
</ul>
<a class="header" href="#required-resources" id="required-resources"><h3>Required resources</h3></a>
<ul>
<li>
<p>Always inherit <code>debian-package</code> and include
<code>sources/&lt;source_name&gt;.inc</code> in recipe.</p>
<pre><code class="language-sh">inherit debian-package
require recipes-debian/sources/&lt;source_name&gt;.inc
</code></pre>
</li>
</ul>
<a class="header" href="#reuse-codes-from-meta" id="reuse-codes-from-meta"><h3>Reuse codes from <code>meta</code></h3></a>
<ul>
<li>
<p>Recipe should include available <code>.inc</code> from <code>meta</code> if possible.
File <code>.inc</code> should be included before <code>inherit debian-package</code>,
so <code>SRC_URI</code> can be overridden.
Ex:</p>
<pre><code class="language-sh">require recipes-devtools/binutils/binutils.inc
...
inherit debian-package
</code></pre>
</li>
<li>
<p>Recipe also can reuse patches/local-files from <code>meta</code> if append <code>FILESPATH</code>.
Ex:</p>
<pre><code class="language-sh">FILESPATH_append = &quot;:${COREBASE}/meta/recipes-devtools/sample/sample&quot;
SRC_URI += &quot;file://sample.patch&quot;
</code></pre>
</li>
</ul>
<a class="header" href="#configuration-and-packages-split" id="configuration-and-packages-split"><h3>Configuration and packages split</h3></a>
<ul>
<li>This version of meta-debian aims to be compatible with
Poky more than Debian, so recipe should configure and
split packages same as Poky recipe to avoid conflict.</li>
</ul>
<a class="header" href="#example" id="example"><h1>Example</h1></a>
<p>Assume we want to create recipe for <code>icu</code>.</p>
<ul>
<li>
<p>Generate source code information</p>
<pre><code class="language-sh">touch meta-debian/recipes-debian/sources/icu.inc

# Force debian-source re-generate in case Sources.xz doesn't change
# Ignore this step if you already set DEBIAN_SRC_FORCE_REGEN to &quot;1&quot;
echo 'DEBIAN_SRC_FORCE_REGEN = &quot;1&quot;' &gt;&gt; &lt;build-dir&gt;/conf/local.conf
</code></pre>
</li>
<li>
<p>Create recipe with name <code>icu_debian.bb</code></p>
<pre><code class="language-sh">mkdir meta-debian/recipes-debian/icu
vim meta-debian/recipes-debian/icu_debian.bb
</code></pre>
</li>
<li>
<p>Add <code>LICENSE</code> and <code>LIC_FILES_CHKSUM</code> in recipe</p>
<pre><code class="language-sh">LICENSE = &quot;ICU&quot;
LIC_FILES_CHKSUM = &quot;file://LICENSE;md5=63752c57bd0b365c9af9f427ef79c819&quot;
</code></pre>
</li>
<li>
<p>Handle Debian source code</p>
<pre><code class="language-sh">inherit debian-package
require recipes-debian/sources/icu.inc
</code></pre>
<p>Unlike other package, <code>icu</code> put buildable source in the sub-folder <code>source</code>.
So we need to overwrite <code>S</code> and update <code>LIC_FILES_CHKSUM</code> to a correct path.</p>
<pre><code class="language-sh">LICENSE = &quot;ICU&quot;
LIC_FILES_CHKSUM = &quot;file://../LICENSE;md5=63752c57bd0b365c9af9f427ef79c819&quot;

inherit debian-package
require recipes-debian/sources/icu.inc

S = &quot;${DEBIAN_UNPACK_DIR}/source&quot;
</code></pre>
</li>
<li>
<p>Reuse codes from <code>meta</code>
Layer <code>meta</code> already provide <code>icu.inc</code> with setup for bitbake. Reuse it.</p>
<pre><code class="language-sh">require recipes-support/icu/icu.inc
</code></pre>
<p>If recipe wants to use patch from <code>meta</code>,
it need to append FILESPATH to point to <code>icu</code> patch directory.</p>
<pre><code class="language-sh">FILESPATH_append = &quot;:${COREBASE}/meta/recipes-support/icu/icu&quot;
SRC_URI += &quot;file://fix-install-manx.patch&quot;
</code></pre>
</li>
<li>
<p>Configure and split packages
For <code>icu</code>, all of configurations are put in <code>icu.inc</code>
and we already include it, so nothing left to do.</p>
</li>
</ul>
<a class="header" href="#final-recipe" id="final-recipe"><h3>Final recipe</h3></a>
<pre><code class="language-sh">require recipes-support/icu/icu.inc

LICENSE = &quot;ICU&quot;
LIC_FILES_CHKSUM = &quot;file://../LICENSE;md5=63752c57bd0b365c9af9f427ef79c819&quot;

inherit debian-package
require recipes-debian/sources/icu.inc

FILESPATH_append = &quot;:${COREBASE}/meta/recipes-support/icu/icu&quot;
SRC_URI += &quot;file://fix-install-manx.patch&quot;

S = &quot;${DEBIAN_UNPACK_DIR}/source&quot;
</code></pre>
<a class="header" href="#using-meta-debian-with-bsp-layers" id="using-meta-debian-with-bsp-layers"><h1>Using meta-debian with BSP layers</h1></a>
<p><code>meta-debian</code> can be used with <code>meta-ti</code> or <code>meta-raspberrypi</code>.
The next sections will show how to use <code>meta-debian</code> with
those layers to build image for BeagleBone Black and Raspberry Pi.</p>
<a class="header" href="#beaglebone-black" id="beaglebone-black"><h1>BeagleBone Black</h1></a>
<p>Get meta-ti at <a href="https://git.yoctoproject.org/cgit/cgit.cgi/meta-ti/">https://git.yoctoproject.org/cgit/cgit.cgi/meta-ti/</a>.</p>
<p>Tested with:</p>
<pre><code>poky        : warrior:2e01bc44f914587a2a59c2208ca0322dfb41d2c6
meta-ti     : master:3b40d8db80c793c499848e9a3b224e7661bfcceb
meta-debian : warrior:a2f64c16d7233570dc803e195e1cf2c6bd07e290
</code></pre>
<a class="header" href="#build-1" id="build-1"><h2>Build</h2></a>
<ol>
<li>
<p>Setup build directory.</p>
<pre><code class="language-sh">$ export TEMPLATECONF=meta-debian/conf
$ source ./poky/oe-init-build-env build-bbb
</code></pre>
</li>
<li>
<p>Add <code>meta-ti</code> to <code>conf/bblayers.conf</code>.</p>
<pre><code class="language-sh">$ vi conf/bblayers.conf
...
BBLAYERS ?= &quot; \
  /path/to/poky/meta \
  /path/to/poky/meta-poky \
  /path/to/poky/meta-ti \
  /path/to/poky/meta-debian \
  &quot;
</code></pre>
</li>
<li>
<p>Set <code>MACHINE</code> to <code>beaglebone</code>.</p>
<pre><code class="language-sh">$ vi conf/local.conf
...
MACHINE ??= &quot;beaglebone&quot;
...
</code></pre>
</li>
<li>
<p>Set default config for linux-base.</p>
<pre><code class="language-sh">$ vi conf/local.conf
...
LINUX_DEFCONFIG = &quot;omap2plus_defconfig&quot;
KERNEL_EXTRA_ARGS += &quot;LOADADDR=${UBOOT_ENTRYPOINT}&quot;
</code></pre>
</li>
<li>
<p>Build.
By default, <code>DISTRO</code> is set to 'deby-tiny', so only <code>core-image-minimal</code> is available to build</p>
<pre><code class="language-sh">$ bitbake core-image-minimal
</code></pre>
<p>In <code>conf/local.conf</code>, <code>DISTRO</code> can be changed to 'deby' for building <code>core-image-base</code>.</p>
</li>
</ol>
<p>After finish building, in <code>tmp/deploy/images/beaglebone/</code>, these files should be available:</p>
<ul>
<li>core-image-minimal-beaglebone.cpio.gz</li>
<li>MLO</li>
<li>u-boot.img</li>
</ul>
<a class="header" href="#boot" id="boot"><h2>Boot</h2></a>
<ol>
<li>
<p>Create two partitions on the SD card: BOOT (FAT32) and ROOT (ext4).</p>
</li>
<li>
<p>Install the root file system.</p>
<pre><code class="language-sh">$ cd /mount/dir/of/ROOT
$ zcat /path/to/core-image-minimal-beaglebone.cpio.gz | sudo cpio -idm --no-absolute-filenames
</code></pre>
</li>
<li>
<p>Install the bootloader. If ROOT is the 2nd partition, <code>mmcroot</code> should be <code>/dev/mmcblk0p2</code>.</p>
<pre><code class="language-sh">$ sudo cp MLO u-boot.img /mount/dir/of/BOOT
$ sudo vi /mount/dir/of/BOOT/uEnv.txt
bootpart=0:2
bootdir=/boot
bootfile=zImage
console=ttyO0,115200n8
fdtaddr=0x81000000
fdtfile=am335x-boneblack.dtb
loadaddr=0x80008000
mmcroot=/dev/mmcblk0p2 ro
mmcrootfstype=ext4 rootwait
mmcargs=setenv bootargs console=${console} root=${mmcroot} rootfstype=${mmcrootfstype}
loadfdt=load mmc ${bootpart} ${fdtaddr} ${bootdir}/${fdtfile}
loadimage=load mmc ${bootpart} ${loadaddr} ${bootdir}/${bootfile}
uenvcmd=if run loadfdt; then echo Loaded ${fdtfile}; if run loadimage; then run mmcargs; bootz ${loadaddr} - ${fdtaddr}; fi; fi;
</code></pre>
</li>
<li>
<p>Connect <a href="https://elinux.org/Beagleboard:BeagleBone_Black_Serial">serial cable</a>
to the board on jumper J1. We tested with Adafruit 4 Pin Cable which has 4 wires:
Black, Green, White, Red. Just leave the RED wire unconnected.</p>
<pre><code>J1   : [GND]   *   *   [RX]    [TX]   *
Cable: [Black]         [Green] [White]
</code></pre>
<p>Boot the board.</p>
<pre><code>$ sudo picocom -b 115200 /dev/ttyUSB0
picocom v3.1

port is        : /dev/ttyUSB0
flowcontrol    : none
baudrate is    : 115200
...&lt;many logs&gt;

U-Boot 2018.03-00002-gac9cce7c6a (Apr 05 2018 - 13:07:46 -0500), Build: jenkins-github_Bootloader-Builder-47

CPU  : AM335X-GP rev 2.1
I2C:   ready
DRAM:  512 MiB
....&lt;many logs&gt;

Starting kernel ...

[    0.000000] Booting Linux on physical CPU 0x0
[    0.000000] Linux version 4.19.13-cip1 (oe-user@oe-host) (gcc version 8.3.0 (GCC)) #1 SMP Thu Mar 21 06:02:24 UTC 2019
[    0.000000] CPU: ARMv7 Processor [413fc082] revision 2 (ARMv7), cr=10c5387d
.....&lt;many logs&gt;
starting pid 64, tty '': '/etc/init.d/rcS'
starting pid 66, tty '/dev/ttyS0': '/sbin/getty 115200 ttyS0'

Deby 10.0 beaglebone /dev/ttyS0

beaglebone login:
</code></pre>
<p>Then login with <code>root</code> (no password).</p>
</li>
</ol>
<a class="header" href="#raspberry-pi" id="raspberry-pi"><h1>Raspberry Pi</h1></a>
<p>Get meta-raspberrypi at <a href="https://git.yoctoproject.org/cgit/cgit.cgi/meta-raspberrypi">https://git.yoctoproject.org/cgit/cgit.cgi/meta-raspberrypi</a>.</p>
<p>Tested with:</p>
<pre><code>poky             : warrior:2e01bc44f914587a2a59c2208ca0322dfb41d2c6
meta-raspberrypi : master:7059c374512f1c1c0df9ecab0703d11438bdf78b
meta-debian      : warrior:bd72b661fe530af12503300ba5e0bdb45fc41408
</code></pre>
<a class="header" href="#build-2" id="build-2"><h2>Build</h2></a>
<ol>
<li>
<p>Setup build directory.</p>
<pre><code class="language-sh">$ export TEMPLATECONF=meta-debian/conf
$ source ./poky/oe-init-build-env build-pi
</code></pre>
</li>
<li>
<p>Add layer <code>meta-raspberrypi</code> to <code>conf/bblayers.conf</code>.</p>
<pre><code class="language-sh">$ vi conf/bblayers.conf
...
BBLAYERS ?= &quot; \
  /path/to/poky/meta \
  /path/to/poky/meta-poky \
  /path/to/poky/meta-raspberrypi \
  /path/to/poky/meta-debian \
  &quot;
</code></pre>
</li>
<li>
<p>We do the test with Raspberry Pi 3, so set <code>MACHINE</code> to <code>raspberrypi3</code>.</p>
<pre><code class="language-sh">$ vi conf/local.conf
...
MACHINE ??= &quot;raspberrypi3&quot;
...
</code></pre>
</li>
<li>
<p>Use raspberrypi kernel.</p>
<pre><code class="language-sh">$ vi conf/local.conf
...
LINUX_GIT_URI = &quot;git://github.com/raspberrypi&quot;
LINUX_GIT_PROTOCOL = &quot;https&quot;
LINUX_GIT_PREFIX = &quot;&quot;
LINUX_GIT_REPO = &quot;linux.git&quot;
LINUX_GIT_BRANCH = &quot;rpi-4.19.y&quot;

LINUX_DEFCONFIG_raspberrypi0-wifi ?= &quot;bcmrpi_defconfig&quot;
LINUX_DEFCONFIG_raspberrypi ?= &quot;bcmrpi_defconfig&quot;
LINUX_DEFCONFIG_raspberrypi2 ?= &quot;bcm2709_defconfig&quot;
LINUX_DEFCONFIG_raspberrypi3 ?= &quot;bcm2709_defconfig&quot;
LINUX_DEFCONFIG_raspberrypi3-64 ?= &quot;bcmrpi3_defconfig&quot;
</code></pre>
</li>
<li>
<p>Configuration for <code>deby-tiny</code>
meta-debian provides 2 <code>DISTRO</code>, 'deby-tiny' (default) and 'deby'.
The below configurations is only for 'deby-tiny'.</p>
<pre><code class="language-sh">$ vi conf/local.conf
...
# If the board is connected with a monitor, and we want login prompt on tty1.
# NOTE: Don't add this config when build with DISTRO 'deby' or it will duplicate.
SERIAL_CONSOLES_append = &quot; 115200;tty1&quot;

# Provide image output for easier to install
IMAGE_FSTYPES_append = &quot; rpi-sdimg&quot;
</code></pre>
</li>
<li>
<p>Build:
By default, <code>DISTRO</code> is set to 'deby-tiny', so only <code>core-image-minimal</code> is available to build</p>
<pre><code class="language-sh">$ bitbake core-image-minimal
</code></pre>
<p>In <code>conf/local.conf</code>, <code>DISTRO</code> can be changed to 'deby' for building <code>core-image-base</code>.</p>
</li>
</ol>
<p>After finish building, <code>tmp/deploy/images/raspberrypi3/core-image-minimal-raspberrypi3.rpi-sdimg</code> should be available.</p>
<a class="header" href="#boot-1" id="boot-1"><h2>Boot</h2></a>
<ol>
<li>
<p>Burn sdimg file to SD card using <a href="https://www.balena.io/etcher/">etcher</a> or <code>dd</code>:</p>
<pre><code class="language-sh"># Assume /dev/sdb is target SD card
$ sudo dd if=core-image-minimal-raspberrypi3.rpi-sdimg of=/dev/sdb
</code></pre>
</li>
<li>
<p>Boot the SD card on the board and login with <code>root</code> (no password).</p>
</li>
</ol>
<a class="header" href="#appendix" id="appendix"><h1>Appendix</h1></a>
<a class="header" href="#version-comparison" id="version-comparison"><h2>Version comparison</h2></a>
<p>Below is the packages version comparison between Debian 10 and Poky.
The comparison is done with Poky 2.6 (thud), 2.7 (warrior) and 2.8 (master).</p>
<p><em>Note: Poky 2.8 has not released yet, so we use the current branch master instead.</em></p>
<pre><code>meta-debian : 51c6c0a175b8e3a91bec803a0a792fed00029e6e
poky 2.6    : 50f33d3bfebcbfb1538d932fb487cfd789872026
poky 2.7    : 0e392026ffefee098a890c39bc3ca1f697bacb52
poky 2.8    : c23c8ebc7f66a92110bfc9e3c4d633a432d1353b
</code></pre>
<p><em>Note: Packages with version NA mean they are not provided.</em></p>
<table><thead><tr><th>            </th><th> Debian 10       </th><th> Poky 2.6        </th><th> Poky 2.7        </th><th> Poky 2.8        </th></tr></thead><tbody>
<tr><td> autoconf   </td><td> 2.69            </td><td> 2.69            </td><td> 2.69            </td><td> 2.69            </td></tr>
<tr><td> automake   </td><td> 1.16.1          </td><td> 1.16.1          </td><td> 1.16.1          </td><td> 1.16.1          </td></tr>
<tr><td> bc         </td><td> 1.07.1          </td><td> 1.07.1          </td><td> 1.07.1          </td><td> 1.07.1          </td></tr>
<tr><td> binutils   </td><td> 2.31.1          </td><td> 2.31.1          </td><td> <strong>2.32.0</strong>      </td><td> <strong>2.32.0</strong>      </td></tr>
<tr><td> bison      </td><td> 3.3.2           </td><td> <strong>3.0.4</strong>       </td><td> <strong>3.0.4</strong>       </td><td> <strong>3.0.4</strong>       </td></tr>
<tr><td> busybox    </td><td> 1.30.1          </td><td> <strong>1.29.3</strong>      </td><td> 1.30.1          </td><td> 1.30.1          </td></tr>
<tr><td> bzip2      </td><td> 1.0.6           </td><td> 1.0.6           </td><td> 1.0.6           </td><td> 1.0.6           </td></tr>
<tr><td> curl       </td><td> 7.64.0          </td><td> <strong>7.61.0</strong>      </td><td> 7.64.0          </td><td> <strong>7.64.1</strong>      </td></tr>
<tr><td> db         </td><td> 5.3.28          </td><td> 5.3.28          </td><td> 5.3.28          </td><td> 5.3.28          </td></tr>
<tr><td> dbus       </td><td> 1.12.12         </td><td> <strong>1.12.10</strong>     </td><td> 1.12.12         </td><td> 1.12.12         </td></tr>
<tr><td> ed         </td><td> 1.15            </td><td> <strong>1.14.2</strong>      </td><td> 1.15            </td><td> 1.15            </td></tr>
<tr><td> expat      </td><td> 2.2.6           </td><td> 2.2.6           </td><td> 2.2.6           </td><td> 2.2.6           </td></tr>
<tr><td> flex       </td><td> 2.6.4           </td><td> <strong>2.6.0</strong>       </td><td> <strong>2.6.0</strong>       </td><td> <strong>2.6.0</strong>       </td></tr>
<tr><td> gawk       </td><td> 4.2.1           </td><td> 4.2.1           </td><td> 4.2.1           </td><td> 4.2.1           </td></tr>
<tr><td> gcc        </td><td> 8.3.0           </td><td> <strong>8.2.0</strong>       </td><td> 8.3.0           </td><td> 8.3.0           </td></tr>
<tr><td> gdb        </td><td> 8.2.1           </td><td> <strong>8.2</strong>         </td><td> 8.2.1           </td><td> 8.2.1           </td></tr>
<tr><td> gettext    </td><td> 0.19.8.1        </td><td> 0.19.8.1        </td><td> 0.19.8.1        </td><td> 0.19.8.1        </td></tr>
<tr><td> git        </td><td> 2.20.1          </td><td> <strong>2.18.1</strong>      </td><td> 2.20.1          </td><td> 2.20.1          </td></tr>
<tr><td> glib-2.0   </td><td> 2.58.3          </td><td> <strong>2.58.0</strong>      </td><td> 2.58.3          </td><td> 2.58.3          </td></tr>
<tr><td> glibc      </td><td> 2.28            </td><td> 2.28            </td><td> <strong>2.29</strong>        </td><td> <strong>2.29</strong>        </td></tr>
<tr><td> gmp        </td><td> 6.1.2           </td><td> 6.1.2           </td><td> 6.1.2           </td><td> 6.1.2           </td></tr>
<tr><td> gnulib     </td><td> 20140202+stable </td><td> <strong>NA</strong>          </td><td> <strong>NA</strong>          </td><td> <strong>NA</strong>          </td></tr>
<tr><td> gzip       </td><td> 1.9             </td><td> 1.9             </td><td> <strong>1.10</strong>        </td><td> <strong>1.10</strong>        </td></tr>
<tr><td> kbd        </td><td> 2.0.4           </td><td> 2.0.4           </td><td> 2.0.4           </td><td> 2.0.4           </td></tr>
<tr><td> libtool    </td><td> 2.4.6           </td><td> 2.4.6           </td><td> 2.4.6           </td><td> 2.4.6           </td></tr>
<tr><td> libxml2    </td><td> 2.9.4           </td><td> <strong>2.9.8</strong>       </td><td> <strong>2.9.8</strong>       </td><td> <strong>2.9.8</strong>       </td></tr>
<tr><td> m4         </td><td> 1.4.18          </td><td> 1.4.18          </td><td> 1.4.18          </td><td> 1.4.18          </td></tr>
<tr><td> make       </td><td> 4.2.1           </td><td> 4.2.1           </td><td> 4.2.1           </td><td> 4.2.1           </td></tr>
<tr><td> libmpc     </td><td> 1.1.0           </td><td> 1.1.0           </td><td> 1.1.0           </td><td> 1.1.0           </td></tr>
<tr><td> mpfr       </td><td> 4.0.2           </td><td> <strong>4.0.1</strong>       </td><td> 4.0.2           </td><td> 4.0.2           </td></tr>
<tr><td> ncurses    </td><td> 6.1+20181013    </td><td> <strong>6.1+20180630</strong></td><td> 6.1+20181013    </td><td> 6.1+20181013    </td></tr>
<tr><td> openssl    </td><td> 1.1.1b          </td><td> <strong>1.1.1a</strong>      </td><td> 1.1.1b          </td><td> 1.1.1b          </td></tr>
<tr><td> pax-utils  </td><td> 1.2.4           </td><td> <strong>NA</strong>          </td><td> <strong>NA</strong>          </td><td> <strong>NA</strong>          </td></tr>
<tr><td> pciutils   </td><td> 3.5.2           </td><td> <strong>3.6.2</strong>       </td><td> <strong>3.6.2</strong>       </td><td> <strong>3.6.2</strong>       </td></tr>
<tr><td> perl       </td><td> 5.28.1          </td><td> <strong>5.24.4</strong>      </td><td> 5.28.1          </td><td> 5.28.1          </td></tr>
<tr><td> pkgconfig  </td><td> 0.29            </td><td> <strong>0.29.2</strong>      </td><td> <strong>0.29.2</strong>      </td><td> <strong>0.29.2</strong>      </td></tr>
<tr><td> popt       </td><td> 1.16            </td><td> 1.16            </td><td> 1.16            </td><td> 1.16            </td></tr>
<tr><td> procps     </td><td> 3.3.15          </td><td> 3.3.15          </td><td> 3.3.15          </td><td> 3.3.15          </td></tr>
<tr><td> quilt      </td><td> 0.65            </td><td> 0.65            </td><td> 0.65            </td><td> 0.65            </td></tr>
<tr><td> rdma-core  </td><td> 22.1            </td><td> <strong>NA</strong>          </td><td> <strong>NA</strong>          </td><td> <strong>NA</strong>          </td></tr>
<tr><td> readline   </td><td> 7.0             </td><td> 7.0             </td><td> <strong>8.0</strong>         </td><td> <strong>8.0</strong>         </td></tr>
<tr><td> sysfsutils </td><td> 2.1.0           </td><td> 2.1.0           </td><td> 2.1.0           </td><td> 2.1.0           </td></tr>
<tr><td> tar        </td><td> 1.30            </td><td> 1.30            </td><td> <strong>1.31</strong>        </td><td> <strong>1.32</strong>        </td></tr>
<tr><td> u-boot     </td><td> 2019.01         </td><td> <strong>2018.07</strong>     </td><td> 2019.01         </td><td> <strong>2019.04</strong>     </td></tr>
<tr><td> unifdef    </td><td> 2.10            </td><td> <strong>2.11</strong>        </td><td> <strong>2.11</strong>        </td><td> <strong>2.11</strong>        </td></tr>
<tr><td> zlib       </td><td> 1.2.11          </td><td> 1.2.11          </td><td> 1.2.11          </td><td> 1.2.11          </td></tr>
</tbody></table>
<table><thead><tr><th>                                                    </th><th> Poky 2.6 </th><th> Poky 2.7 </th><th> Poky 2.8 </th></tr></thead><tbody>
<tr><td> Number of packages with same version               </td><td> 24       </td><td> 32       </td><td> 30       </td></tr>
<tr><td> Number of packages with lower version than Debian  </td><td> 15       </td><td> 2        </td><td> 2        </td></tr>
<tr><td> Number of packages with higher version than Debian </td><td> 4        </td><td> 9        </td><td> 11       </td></tr>
<tr><td> Number of packages are not provided in Poky        </td><td> 3        </td><td> 3        </td><td> 3        </td></tr>
</tbody></table>
<p>Poky 2.8 is planned to be released in Oct 2019, so the number of packages
with different version may continue increase in future.</p>
<a class="header" href="#community-resources" id="community-resources"><h1>Community Resources</h1></a>
<a class="header" href="#project-home" id="project-home"><h4>Project home</h4></a>
<ul>
<li><a href="https://github.com/meta-debian/meta-debian">https://github.com/meta-debian/meta-debian</a></li>
</ul>
<a class="header" href="#mailing-list" id="mailing-list"><h4>Mailing list</h4></a>
<ul>
<li><a href="mailto:meta-debian@googlegroups.com">meta-debian@googlegroups.com</a></li>
</ul>
<a class="header" href="#mailing-list-subscription" id="mailing-list-subscription"><h4>Mailing list subscription</h4></a>
<ul>
<li><a href="mailto:meta-debian+subscribe@googlegroups.com">meta-debian+subscribe@googlegroups.com</a></li>
<li><a href="https://groups.google.com/forum/#!forum/meta-debian/join">https://groups.google.com/forum/#!forum/meta-debian/join</a></li>
</ul>
<a class="header" href="#license" id="license"><h1>License</h1></a>
<p>License of meta-debian is same as meta in poky i.e.
All metadata is MIT licensed unless otherwise stated.
Source code included in tree for individual recipes is under the LICENSE stated in the associated recipe (.bb file) unless otherwise stated.</p>
<p>See COPYING.MIT for more details about MIT license.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        

                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                

                
            </nav>

        </div>

        

        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        
        
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
        
        

    </body>
</html>
